<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Gemini-style Voice Assistant ‚Äî Mobile</title>
  <style>
    :root{--bg1:#ffffff;--bg2:#eef6ff;--accent1:#276ef1;--accent2:#8bd3ff;--card:#ffffff;--muted:#6b7280}
    html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial}
    body{background:linear-gradient(180deg,var(--bg2),var(--bg1));display:flex;align-items:flex-start;justify-content:center;padding:20px}
    .container{width:100%;max-width:720px;background:transparent}.header{background:linear-gradient(90deg,var(--accent1),var(--accent2));border-radius:16px;padding:18px;color:white;box-shadow:0 6px 20px rgba(39,110,241,0.14);display:flex;gap:12px;align-items:center}
.logo{width:44px;height:44px;border-radius:10px;background:rgba(255,255,255,0.12);display:flex;align-items:center;justify-content:center;font-weight:700}
.title{font-size:16px;font-weight:600}
.subtitle{font-size:12px;opacity:0.95}

.card{background:var(--card);border-radius:14px;padding:16px;margin-top:14px;box-shadow:0 6px 20px rgba(15,23,42,0.06)}
.transcript{min-height:74px;border-radius:10px;padding:12px;background:#fafafa;border:1px solid #f0f0f3;color:#111;font-size:15px}
.controls{display:flex;gap:8px;margin-top:12px;align-items:center}

.mic-btn{width:70px;height:70px;border-radius:50%;border:none;display:inline-grid;place-items:center;font-size:22px;cursor:pointer;background:linear-gradient(180deg,#fff,#f6f8ff);box-shadow:0 8px 24px rgba(39,110,241,0.18);}
.mic-btn.listening{background:radial-gradient(circle at 30% 30%, #fff6, #fff);box-shadow:0 12px 30px rgba(39,110,241,0.28);transform:scale(1.03)}

.actions{display:flex;gap:8px;align-items:center}
.chip{background:#f3f4f6;padding:8px 10px;border-radius:999px;font-size:13px;color:var(--muted)}

.assistant-response{margin-top:12px;padding:12px;border-radius:10px;background:linear-gradient(180deg,#ffffff,#fbfdff);border:1px solid #eef5ff}
.typing{height:18px;display:inline-block;vertical-align:middle}
.dots span{display:inline-block;width:6px;height:6px;margin:0 2px;border-radius:50%;background:#9fbfff;animation:dot 1s infinite}
.dots span:nth-child(2){animation-delay:.15s}
.dots span:nth-child(3){animation-delay:.3s}
@keyframes dot{0%{transform:translateY(0)}50%{transform:translateY(-6px)}100%{transform:translateY(0)}}

.footer{font-size:13px;color:var(--muted);margin-top:10px;text-align:center}

.settings{margin-top:12px;display:flex;gap:8px;flex-wrap:wrap}
.select, .range{padding:8px;border-radius:8px;border:1px solid #eee;background:white}
label{font-size:13px;color:var(--muted);display:block;margin-bottom:6px}

/* responsive */
@media (max-width:420px){.mic-btn{width:62px;height:62px;font-size:20px}.header{padding:14px}.title{font-size:15px}}

  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="logo">G</div>
      <div>
        <div class="title">Gemini-style Voice Assistant</div>
        <div class="subtitle">Speak naturally ‚Äî replies with voice. (Local demo)</div>
      </div>
    </div><div class="card">
  <div class="transcript" id="transcript">Say something ‚Äî tap the mic üéôÔ∏è</div>

  <div class="controls">
    <button id="mic" class="mic-btn" aria-label="Start listening">üé§</button>
    <div class="actions">
      <div class="chip" id="status">Idle</div>
      <div style="width:8px"></div>
      <button id="stopBtn" class="chip">Stop</button>
    </div>
  </div>

  <div class="assistant-response" id="responseArea">
    <div style="font-weight:600">Assistant</div>
    <div id="responseText" style="margin-top:8px;color:#111;min-height:32px">Hello ‚Äî I am your local voice assistant. Try: "What's the time?", "Open YouTube", "Tell me a joke".</div>
  </div>

  <div class="settings">
    <div>
      <label for="voiceSelect">Voice</label>
      <select id="voiceSelect" class="select"></select>
    </div>
    <div>
      <label for="rate">Rate</label>
      <input id="rate" class="range" type="range" min="0.6" max="1.6" step="0.1" value="1">
    </div>
    <div>
      <label for="pitch">Pitch</label>
      <input id="pitch" class="range" type="range" min="0.4" max="2" step="0.1" value="1">
    </div>
  </div>

  <div class="footer">Works best in Chrome/Edge on Android. Uses browser SpeechRecognition + SpeechSynthesis. No external AI required.</div>
</div>

  </div>  <script>
    // Feature detection
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    const synth = window.speechSynthesis;

    const micBtn = document.getElementById('mic');
    const transcriptEl = document.getElementById('transcript');
    const statusChip = document.getElementById('status');
    const responseText = document.getElementById('responseText');
    const stopBtn = document.getElementById('stopBtn');

    const voiceSelect = document.getElementById('voiceSelect');
    const rateInput = document.getElementById('rate');
    const pitchInput = document.getElementById('pitch');

    let recognition, listening=false;

    if(!SpeechRecognition){
      transcriptEl.innerText = 'SpeechRecognition not supported in this browser. Use Chrome on Android.';
      micBtn.disabled = true;
      statusChip.innerText = 'Unsupported';
    } else {
      recognition = new SpeechRecognition();
      recognition.lang = 'en-IN';
      recognition.interimResults = true;
      recognition.maxAlternatives = 1;

      let finalTranscript = '';

      recognition.onstart = () => { listening=true; micBtn.classList.add('listening'); statusChip.innerText='Listening...'; }
      recognition.onend = () => { listening=false; micBtn.classList.remove('listening'); statusChip.innerText='Idle'; }

      recognition.onresult = (e) => {
        let interim = '';
        for(let i=e.resultIndex;i<e.results.length;i++){
          const res = e.results[i];
          if(res.isFinal){ finalTranscript += res[0].transcript; }
          else { interim += res[0].transcript; }
        }
        transcriptEl.innerText = (finalTranscript + ' ' + interim).trim();

        // If final comes in, process
        if(e.results[e.results.length-1].isFinal){
          const userText = finalTranscript.trim();
          finalTranscript='';
          processUserText(userText);
        }
      }

      recognition.onerror = (ev) => {
        console.error('Speech error', ev.error);
        statusChip.innerText = 'Error: ' + ev.error;
        setTimeout(()=> statusChip.innerText='Idle', 2500);
      }

    }

    // mic toggle
    micBtn.addEventListener('click', ()=>{
      if(!recognition) return;
      if(!listening){ try{ recognition.start(); statusChip.innerText='Listening...'; transcriptEl.innerText=''; }catch(e){console.warn(e)} }
      else { recognition.stop(); statusChip.innerText='Stopping...'; }
    });

    stopBtn.addEventListener('click', ()=>{ if(recognition && listening) recognition.stop(); transcriptEl.innerText=''; });

    // basic local NLP / response logic
    function processUserText(text){
      console.log('user said:', text);
      showThinking();
      // simple intents
      const t = text.toLowerCase();
      let reply = "I didn't catch that. Can you rephrase?";

      if(/hello|hi\b/.test(t)) reply = 'Hey there! How can I help?';
      else if(/time|what time/.test(t)) reply = `It's ${new Date().toLocaleTimeString()}.`;
      else if(/date|day/.test(t)) reply = `Today is ${new Date().toLocaleDateString()}.`;
      else if(/joke/.test(t)) reply = 'Why did the computer get cold? Because it left its Windows open!';
      else if(/your name/.test(t)) reply = 'I am your local Gemini-style assistant.';
      else if(/open (youtube|google|gmail)/.test(t)){
        const site = t.match(/open (youtube|google|gmail)/)[1];
        reply = `Opening ${site}...`;
        // open the site after speaking
        speakAndMaybeOpen(reply, site);
        return;
      } else if(/search for (.+)/.test(t)){
        const q = t.match(/search for (.+)/)[1];
        reply = `Searching the web for: ${q}. I will open a results page.`;
        speak(reply, ()=>{ window.open('https://www.google.com/search?q=' + encodeURIComponent(q), '_blank'); });
        return;
      } else if(/thank/.test(t)) reply = 'You are welcome!';
      else {
        // fallback: echo short summary
        reply = 'You said: ' + text;
      }

      speak(reply);
    }

    function showThinking(){
      responseText.innerHTML = '<div style="display:flex;align-items:center;gap:8px"><div style="font-weight:600">Thinking</div><div class="dots"><span></span><span></span><span></span></div></div>';
    }

    function speakAndMaybeOpen(reply, site){
      speak(reply, ()=>{
        const urls = {youtube:'https://m.youtube.com', google:'https://www.google.com', gmail:'https://mail.google.com'};
        const url = urls[site] || 'https://www.'+site+'.com';
        window.open(url,'_blank');
      });
    }

    function speak(text, onend){
      // small delay to simulate thinking
      setTimeout(()=>{
        responseText.textContent = text;

        if(!('speechSynthesis' in window)){
          statusChip.innerText='TTS unsupported';
          if(onend) onend();
          return;
        }
        const utter = new SpeechSynthesisUtterance(text);
        const selectedIndex = voiceSelect.selectedIndex >=0 ? voiceSelect.selectedIndex : 0;
        const voices = synth.getVoices();
        if(voices[selectedIndex]) utter.voice = voices[selectedIndex];
        utter.rate = parseFloat(rateInput.value);
        utter.pitch = parseFloat(pitchInput.value);
        utter.onstart = ()=> statusChip.innerText='Speaking...';
        utter.onend = ()=>{ statusChip.innerText='Idle'; if(onend) onend(); }
        synth.cancel();
        synth.speak(utter);
      }, 700);
    }

    // populate voices
    function populateVoices(){
      const voices = synth.getVoices();
      voiceSelect.innerHTML='';
      voices.forEach((v,i)=>{
        const opt = document.createElement('option');
        opt.value = i; opt.textContent = `${v.name} ‚Äî ${v.lang}` + (v.default? ' (default)':'');
        voiceSelect.appendChild(opt);
      });
    }
    populateVoices();
    if (speechSynthesis.onvoiceschanged !== undefined) { speechSynthesis.onvoiceschanged = populateVoices; }

    // initial greeting
    setTimeout(()=> speak('Hello ‚Äî tap the mic and speak. I am ready.'), 900);

  </script></body>
</html>
